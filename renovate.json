{
  "extends": ["config:base"],
  "regexManagers": [
    {
      "fileMatch": [".github/build/docker/security-image-matrix.yml"],
      "matchStrings": [
        "BASE_TOOL_IMAGE:\\s*(?<depName>.*?)(:(?<currentValue>[\\w.\\-]+))?(?<digest>@sha256:[a-f0-9]+)?"
      ],
      "depNameTemplate": "{{{ depName }}}",
      "versioningTemplate": "docker",
      "datasourceTemplate": "docker",
      "extractVersionTemplate": "{{{ currentValue }}}{{{ digest }}}"
    },
    {
      "fileMatch": [".github/build/docker/security-image-matrix.yml"],
      "matchStrings": [
        "BASE_IMAGE:\\s*(?<depName>.*?)(:(?<currentValue>[\\w.\\-]+))?(?<digest>@sha256:[a-f0-9]+)?"
      ],
      "depNameTemplate": "{{{ depName }}}",
      "versioningTemplate": "docker",
      "datasourceTemplate": "docker",
      "extractVersionTemplate": "{{{ currentValue }}}{{{ digest }}}"
    },
    {
      "fileMatch": [".github/build/docker/security-image-matrix.yml"],
      "matchStrings": [
        "DB_IMAGE:\\s*(?<depName>.*?)(:(?<currentValue>[\\w.\\-]+))?(?<digest>@sha256:[a-f0-9]+)?"
      ],
      "depNameTemplate": "{{{ depName }}}",
      "versioningTemplate": "docker",
      "datasourceTemplate": "docker",
      "extractVersionTemplate": "{{{ currentValue }}}{{{ digest }}}"
    },
    {
      "fileMatch": [".github/build/docker/security-image-matrix.yml"],
      "matchStrings": [
        "DB_TAG:\\s*(?<currentValue>[\\w.\\-]+)"
      ],
      "depNameTemplate": "public.ecr.aws/aquasecurity/trivy-db",
      "versioningTemplate": "docker",
      "datasourceTemplate": "docker"
    }
  ],
  "packageRules": [
    {
      "matchDatasources": ["docker"],
      "matchDepNames": ["public.ecr.aws/aquasecurity/trivy-db"],
      "registryUrls": ["https://public.ecr.aws"]
    }
  ]
}
